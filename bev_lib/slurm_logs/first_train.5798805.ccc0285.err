/home/xiyuez2/.conda/envs/center2/lib/python3.7/site-packages/torch/distributed/launch.py:186: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  FutureWarning,
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
2022-07-06 01:11:42,400 - INFO - Distributed training: True
2022-07-06 01:11:42,401 - INFO - torch.backends.cudnn.benchmark: False
2022-07-06 01:11:42,528 - INFO - Finish RPN Initialization
2022-07-06 01:11:42,528 - INFO - num_classes: [1, 2, 2, 1, 2, 2]
2022-07-06 01:11:42,551 - INFO - Finish CenterHead Initialization
2022-07-06 01:12:37,586 - INFO - {'car': 5, 'truck': 5, 'bus': 5, 'trailer': 5, 'construction_vehicle': 5, 'traffic_cone': 5, 'barrier': 5, 'motorcycle': 5, 'bicycle': 5, 'pedestrian': 5}
2022-07-06 01:12:37,589 - INFO - [-1]
2022-07-06 01:12:40,411 - INFO - load 62964 traffic_cone database infos
2022-07-06 01:12:40,411 - INFO - load 65262 truck database infos
2022-07-06 01:12:40,411 - INFO - load 339949 car database infos
2022-07-06 01:12:40,411 - INFO - load 161928 pedestrian database infos
2022-07-06 01:12:40,411 - INFO - load 26297 ignore database infos
2022-07-06 01:12:40,411 - INFO - load 11050 construction_vehicle database infos
2022-07-06 01:12:40,411 - INFO - load 107507 barrier database infos
2022-07-06 01:12:40,411 - INFO - load 8846 motorcycle database infos
2022-07-06 01:12:40,412 - INFO - load 8185 bicycle database infos
2022-07-06 01:12:40,412 - INFO - load 12286 bus database infos
2022-07-06 01:12:40,412 - INFO - load 19202 trailer database infos
2022-07-06 01:12:41,546 - INFO - After filter database:
2022-07-06 01:12:41,547 - INFO - load 55823 traffic_cone database infos
2022-07-06 01:12:41,547 - INFO - load 60428 truck database infos
2022-07-06 01:12:41,547 - INFO - load 294575 car database infos
2022-07-06 01:12:41,547 - INFO - load 148872 pedestrian database infos
2022-07-06 01:12:41,547 - INFO - load 26297 ignore database infos
2022-07-06 01:12:41,547 - INFO - load 10591 construction_vehicle database infos
2022-07-06 01:12:41,547 - INFO - load 102093 barrier database infos
2022-07-06 01:12:41,547 - INFO - load 8055 motorcycle database infos
2022-07-06 01:12:41,547 - INFO - load 7533 bicycle database infos
2022-07-06 01:12:41,547 - INFO - load 11622 bus database infos
2022-07-06 01:12:41,547 - INFO - load 18104 trailer database infos
2022-07-06 01:12:54,603 - INFO - Start running, host: xiyuez2@ccc0285.campuscluster.illinois.edu, work_dir: /projects/perception/personals/xiyue/CenterPoint_cuda11/work_dirs/nusc_centerpoint_pp_02voxel_two_pfn_10sweep
2022-07-06 01:12:54,603 - INFO - workflow: [('train', 1)], max: 20 epochs
Traceback (most recent call last):
  File "./tools/train.py", line 169, in <module>
    main()
  File "./tools/train.py", line 164, in main
    logger=logger,
  File "/projects/perception/personals/xiyue/CenterPoint_cuda11/det3d/torchie/apis/train.py", line 333, in train_detector
Traceback (most recent call last):
  File "./tools/train.py", line 169, in <module>
    main()
  File "./tools/train.py", line 164, in main
    logger=logger,
  File "/projects/perception/personals/xiyue/CenterPoint_cuda11/det3d/torchie/apis/train.py", line 333, in train_detector
    trainer.run(data_loaders, cfg.workflow, cfg.total_epochs, local_rank=cfg.local_rank)
  File "/projects/perception/personals/xiyue/CenterPoint_cuda11/det3d/torchie/trainer/trainer.py", line 560, in run
    trainer.run(data_loaders, cfg.workflow, cfg.total_epochs, local_rank=cfg.local_rank)
  File "/projects/perception/personals/xiyue/CenterPoint_cuda11/det3d/torchie/trainer/trainer.py", line 560, in run
    epoch_runner(data_loaders[i], self.epoch, **kwargs)
  File "/projects/perception/personals/xiyue/CenterPoint_cuda11/det3d/torchie/trainer/trainer.py", line 404, in train
    epoch_runner(data_loaders[i], self.epoch, **kwargs)
  File "/projects/perception/personals/xiyue/CenterPoint_cuda11/det3d/torchie/trainer/trainer.py", line 404, in train
    for i, data_batch in enumerate(data_loader):
  File "/home/xiyuez2/.conda/envs/center2/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 359, in __iter__
    for i, data_batch in enumerate(data_loader):
  File "/home/xiyuez2/.conda/envs/center2/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 359, in __iter__
    return self._get_iterator()
  File "/home/xiyuez2/.conda/envs/center2/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 305, in _get_iterator
    return self._get_iterator()
  File "/home/xiyuez2/.conda/envs/center2/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 305, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/xiyuez2/.conda/envs/center2/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 918, in __init__
    return _MultiProcessingDataLoaderIter(self)
  File "/home/xiyuez2/.conda/envs/center2/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 918, in __init__
    w.start()
  File "/home/xiyuez2/.conda/envs/center2/lib/python3.7/multiprocessing/process.py", line 112, in start
    w.start()
  File "/home/xiyuez2/.conda/envs/center2/lib/python3.7/multiprocessing/process.py", line 112, in start
    self._popen = self._Popen(self)
  File "/home/xiyuez2/.conda/envs/center2/lib/python3.7/multiprocessing/context.py", line 223, in _Popen
    self._popen = self._Popen(self)
  File "/home/xiyuez2/.conda/envs/center2/lib/python3.7/multiprocessing/context.py", line 223, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/xiyuez2/.conda/envs/center2/lib/python3.7/multiprocessing/context.py", line 277, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/home/xiyuez2/.conda/envs/center2/lib/python3.7/multiprocessing/context.py", line 277, in _Popen
    return Popen(process_obj)
  File "/home/xiyuez2/.conda/envs/center2/lib/python3.7/multiprocessing/popen_fork.py", line 20, in __init__
    return Popen(process_obj)
  File "/home/xiyuez2/.conda/envs/center2/lib/python3.7/multiprocessing/popen_fork.py", line 20, in __init__
    self._launch(process_obj)
  File "/home/xiyuez2/.conda/envs/center2/lib/python3.7/multiprocessing/popen_fork.py", line 70, in _launch
    self._launch(process_obj)
  File "/home/xiyuez2/.conda/envs/center2/lib/python3.7/multiprocessing/popen_fork.py", line 70, in _launch
    self.pid = os.fork()
OSError: [Errno 12] Cannot allocate memory
    self.pid = os.fork()
OSError: [Errno 12] Cannot allocate memory
2022-07-06 01:13:07,139 - INFO - finding looplift candidates
2022-07-06 01:13:09,621 - INFO - Self-intersection at or near point 129.1698879523056 615.07223215816077
2022-07-06 01:13:09,623 - INFO - Self-intersection at or near point -25.279029759125137 603.53502675340678
/projects/perception/personals/xiyue/CenterPoint_cuda11/det3d/datasets/pipelines/loading.py:331: ShapelyDeprecationWarning: Iteration over multi-part geometries is deprecated and will be removed in Shapely 2.0. Use the `geoms` property to access the constituent parts of a multi-part geometry.
  for polys in poly_res:
/projects/perception/personals/xiyue/CenterPoint_cuda11/det3d/datasets/pipelines/loading.py:331: ShapelyDeprecationWarning: Iteration over multi-part geometries is deprecated and will be removed in Shapely 2.0. Use the `geoms` property to access the constituent parts of a multi-part geometry.
  for polys in poly_res:
2022-07-06 01:13:13,859 - INFO - Self-intersection at or near point 218.5686035296853 42.18530484298244
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 2907 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 2909 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 2910 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 1 (pid: 2908) of binary: /home/xiyuez2/.conda/envs/center2/bin/python
Traceback (most recent call last):
  File "/home/xiyuez2/.conda/envs/center2/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/xiyuez2/.conda/envs/center2/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/xiyuez2/.conda/envs/center2/lib/python3.7/site-packages/torch/distributed/launch.py", line 193, in <module>
    main()
  File "/home/xiyuez2/.conda/envs/center2/lib/python3.7/site-packages/torch/distributed/launch.py", line 189, in main
    launch(args)
  File "/home/xiyuez2/.conda/envs/center2/lib/python3.7/site-packages/torch/distributed/launch.py", line 174, in launch
    run(args)
  File "/home/xiyuez2/.conda/envs/center2/lib/python3.7/site-packages/torch/distributed/run.py", line 713, in run
    )(*cmd_args)
  File "/home/xiyuez2/.conda/envs/center2/lib/python3.7/site-packages/torch/distributed/launcher/api.py", line 131, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/xiyuez2/.conda/envs/center2/lib/python3.7/site-packages/torch/distributed/launcher/api.py", line 261, in launch_agent
    failures=result.failures,
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
./tools/train.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2022-07-06_01:13:20
  host      : ccc0285.campuscluster.illinois.edu
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 2908)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
